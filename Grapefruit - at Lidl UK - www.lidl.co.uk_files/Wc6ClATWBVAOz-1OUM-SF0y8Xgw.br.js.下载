(function(){try{var n=window.$MicrosoftMaps8,o=n.Internal,t=n.Pushpin,i=n.Polygon,r=n.Polyline,f=n.Location,e=function(){function n(){}return n.read=function(t,i){return n._parse(t,i)},n.write=function(t){return n._write(t)},n._parseCoordinates=function(t){for(var u=t.replace(/(^\s|\s+$)/gi,"").split(/,\s*/),f=[],i,r=0;r<u.length;r++)i=n._parseCoordinate(u[r]),i!==null&&f.push(i);return f},n._parseCoordinate=function(n){var t=n.replace(/(^\s|\s+$)/gi,"").split(/\s+/);return t.length>1?new f(parseFloat(t[1]),parseFloat(t[0])):null},n._parse=function(t,i){if(t){var r=t.substring(0,t.indexOf("(",0));r=r.replace(/\s/g,"");switch(r.toLowerCase()){case"point":return n._parsePoint(t,i?i.pushpinOptions:null);case"linestring":return n._parseLinestring(t,i?i.polylineOptions:null);case"polygon":return n._parsePolygon(t,i?i.polygonOptions:null);case"multipoint":return n._parseMultiPoint(t,i?i.pushpinOptions:null);case"multilinestring":return n._parseMultiLinestring(t,i?i.polylineOptions:null);case"multipolygon":return n._parseMultiPolygon(t,i?i.polygonOptions:null);case"geometrycollection":return n._parseGeometryCollection(t,i)}}return null},n._parseGeometryCollection=function(t,i){for(var u=[],r,e=t.replace(/(GEOMETRYCOLLECTION\s*\(|(\)\s*)$)/gi,"").replace(/(\))(,\s*)([a-zA-Z])/gi,"$1|$3").split("|"),f=0,o=e.length;f<o;f++)r=n._parse(e[f],i),r!==null&&(r.length?Array.prototype.push.apply(u,r):u.push(r));return u},n._parsePoint=function(i,r){var f,u;return i=i.replace(/(POINT|[\(\)]*)/gi,""),u=n._parseCoordinate(i),u&&(f=new t(u,r?r:null)),f},n._parseLinestring=function(t,i){var f,u;return t=t.replace(/(LINESTRING|[\(\)]*|^\s*|\s$)/gi,""),u=n._parseCoordinates(t),u&&(f=new r(u,i?i:null)),f},n._parsePolygon=function(t,r){for(var e,o=t.replace(/(POLYGON|\(\(|\)\))/gi,"").split(/\),\s*\(/),u=[],f=0,s=o.length;f<s;f++)u.push(n._parseCoordinates(o[f]));return u.length>0&&(e=new i(u,r?r:null)),e},n._parseMultiPoint=function(i,r){for(var f=[],e=i.replace(/(MULTIPOINT|[\(\)]*)/gi,"").split(/,\s*/),u=0,o=e.length;u<o;u++)f.push(new t(n._parseCoordinate(e[u]),r?r:null));return f},n._parseMultiLinestring=function(t,i){for(var f=[],e=t.replace(/(MULTILINESTRING|\(\(|\)\))/gi,"").split(/\),\s*\(/),u=0,o=e.length;u<o;u++)f.push(new r(n._parseCoordinates(e[u]),i?i:null));return f},n._parseMultiPolygon=function(t,r){for(var u,c,s=[],h=t.replace(/(MULTIPOLYGON|\(\(\(|\)\)\))/gi,"").split(/\)\),\s*\(\(/),f,e,o=0,l=h.length;o<l;o++){for(f=[],e=h[o].split(/\),\s*\(/),u=0,c=e.length;u<c;u++)f.push(n._parseCoordinates(e[u]));s.push(new i(f,r?r:null))}return s},n._writeCoordinate=function(n){return Math.round(n.longitude*1e5)/1e5+" "+Math.round(n.latitude*1e5)/1e5},n._writeCoordinates=function(t){for(var i=["("],u=t.length,r=0;r<u;r++)i.push(n._writeCoordinate(t[r])),r<u-1&&i.push(",");return i.push(")"),i.join("")},n._writePoint=function(t){return"POINT("+n._writeCoordinate(t.getLocation())+")"},n._writeLinestring=function(t){return"LINESTRING"+n._writeCoordinates(t.getLocations())},n._writePolygon=function(t){for(var i=["POLYGON("],u=t.getRings(),f=u.length,r=0;r<f;r++)i.push(n._writeCoordinates(u[r])),r<f-1&&i.push(",");return i.push(")"),i.join("")},n._writeGeometryCollection=function(u){for(var a=u&&u.length,e,o=["GEOMETRYCOLLECTION("],f,s=0,h=0,c=0,l=0;l<a;l++)e=u[l],e instanceof i?(o.push(n._writePolygon(e),","),c++):e instanceof t?(o.push(n._writePoint(e),","),s++):e instanceof r&&(o.push(n._writeLinestring(e),","),h++);return f=o.join("").replace(/,+$/g,"")+")",s>0&&h===0&&c===0?f=f.replace(/POINT/gi,"").replace(/GEOMETRYCOLLECTION/gi,"MULTIPOINT"):s===0&&h>0&&c===0?f=f.replace(/LINESTRING/gi,"").replace(/GEOMETRYCOLLECTION/gi,"MULTILINESTRING"):s===0&&h===0&&c>0&&(f=f.replace(/POLYGON/gi,"").replace(/GEOMETRYCOLLECTION/gi,"MULTIPOLYGON")),f},n._write=function(u){return u instanceof i?n._writePolygon(u):u instanceof t?n._writePoint(u):u instanceof r?n._writeLinestring(u):u.length?n._writeGeometryCollection(u):null},n}();n.WellKnownText=e}catch(u){if(n.logger)n.logger.logCriticalError(u);else throw u;}}).call(window)